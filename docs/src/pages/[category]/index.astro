---
import { getEntry } from "astro:content";
import { getCollection, render } from "astro:content";
import Layout from "../../layout.astro";
import SideMenu from "../../components/SideMenu.astro";

export async function getStaticPaths() {
  const allDocs = await getCollection("docs");
  return allDocs.map((doc) => {
    const [category] = doc.id.split("/");
    return {
      params: { category },
    };
  });
}

const { category } = Astro.params;
const entry = await getEntry("docs", [category].join("/"));

if (!entry) {
  throw new Error("404");
}

const { Content, headings, remarkPluginFrontmatter } = await render(entry);
---

<Layout>
  <div class="flex items-start">
    <div class="sticky top-module-4xl w-module-9xl hidden md:block">
      <SideMenu />
    </div>

    <section class="markdown-content md:px-0 w-full md:w-[calc(100%-var(--module-9xl))] overflow-x-hidden">
      <Content />
    </section>
  </div>
</Layout>
