# https://taskfile.dev

version: "3"

includes:
  publish: tasks/npm-publish.yml

tasks:
  default: task -l

  setup:
    desc: Install node dependencies
    cmds:
      - rtx install
      - '[ "$CI" != "" ] && pnpm config set store-dir .pnpm-store || true'
      - pnpm i

  test:
    desc: Run tests on all components
    cmds:
      - task: build
      - npx turbo test --filter=@sv-components/*

  lint:
    desc: Run linter on all components
    cmds:
      - npx turbo lint --filter=@sv-components/*

  dev:
    desc: Run dev server, available under http://localhost:3000/
    cmds:
      - npx turbo dev

  build:
    desc: Build all components
    cmds:
      - npx turbo build --filter=@sv-components/*

  docs:
    desc: Builds the docs into the public folder
    cmds:
      - npm run build
      - npx turbo build --filter=docs
      - mv docs/dist public

  new:
    desc: Create a new component from templates
    dir: "{{.TASKFILE_DIR}}"
    cmds:
      - node ./tasks/new.mjs
