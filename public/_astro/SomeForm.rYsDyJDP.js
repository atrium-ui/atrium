import{B as F}from"./Button.vue._Svzmbdd.js";import{Input as d}from"./Input.iDqIeGHm.js";import{c as a,m as o,r as f,b as m,a as y}from"./runtime-core.esm-bundler.Bu07HdzU.js";import"./index.BuW9Y6i2.js";function x(i){const e=t=>{switch(t.type){case"text":case"name":return a(d,t,null);case"email":return a(d,o({type:"email"},t),null);case"textarea":return a(d,o({multiline:!0},t),null);case"checkbox":return a(d,o({type:"checkbox"},t),null);case"date":return a(d,o({type:"date"},t),null);default:return a(d,t,null)}};return a(f("a-form-field"),null,{default:()=>[a("div",{class:`form-field-${i.field.type}`},[a(e,o(i.field,{label:i.field.description?null:`${i.field.label} ${i.field.required?"":"(optional)"}`,id:i.field.name,class:`form-field-input-${i.field.type}`}),null),i.field.description?a("div",{class:"form-field-description"},[a("label",{for:i.field.name},[i.field.description])]):null]),a("div",{class:"text-red-400 text-xs"},[a(f("a-form-field-error"),null,null)])]})}const v=globalThis.HTMLElement||class{};class b extends v{onState=e=>{const t=e.detail,n=t.getInput();n&&t.valid===!1?this.textContent=n.validationMessage:this.textContent=""};connectedCallback(){this.closest("a-form-field")?.addEventListener("field-state",this.onState)}disconnectedCallback(){this.closest("a-form-field")?.removeEventListener("field-state",this.onState)}}typeof window=="object"&&customElements.define("a-form-field-error",b);class w extends v{valid=!0;getInput(){return this.querySelector("input, textarea")}getForm(){return this.getInput()?.form}connectedCallback(){this.getForm()?.addEventListener("error",this.handleError,!0),this.addEventListener("invalid",this.invalid,{capture:!0}),this.addEventListener("change",this.input,{capture:!0}),this.addEventListener("input",this.input,{capture:!0})}disconnectedCallback(){this.getForm()?.removeEventListener("error",this.handleError,!0),this.removeEventListener("invalid",this.invalid,{capture:!0}),this.removeEventListener("change",this.input,{capture:!0}),this.removeEventListener("input",this.input,{capture:!0})}invalid=e=>{e.preventDefault(),e?.target?.focus(),this.valid=!1,this.dispatchEvent(new CustomEvent("field-state",{detail:this}))};input=e=>{this.getInput()?.setCustomValidity(""),this.valid=e?.target?.reportValidity(),this.dispatchEvent(new CustomEvent("field-state",{detail:this}))};handleError=e=>{const t=this.getInput();t&&e.detail.name===t.name&&(t.setCustomValidity(e.detail.message[0]),t.focus()),this.dispatchEvent(new CustomEvent("field-state",{detail:this}))}}typeof window=="object"&&customElements.define("a-form-field",w);class E{defaultFieldTypeMap={Field_Heading:"heading",Field_Name:"name",Field_Email:"email",Field_SingleLineText:"text",Field_MultiLineText:"textarea",Field_Agree:"checkbox",Field_Date:"date"};getFieldType(e){return this.defaultFieldTypeMap[e.typeName]}getFieldValue(e){return this.getFieldType(e)==="checkbox"?e.defaultValue==="1"||!1:e.defaultValue}renderField(e){const t=this.getFieldType(e);if(!t)return;const n=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"];let s=[];if(e.availableDaysOfWeek)try{const l=JSON.parse(e.availableDaysOfWeek);s=n.filter(r=>!l.includes(r)).map(r=>n.indexOf(r))}catch(l){console.error(l)}return{type:t,description:e.description,label:e.name,error:e.errorMessage,placeholder:e.placeholder,name:e.handle,required:e.required,value:this.getFieldValue(e),disabledDates:{days:s,customPredictor(l){return!!(e.minDate&&l.valueOf()<new Date(e.minDate)||e.maxDate&&l.valueOf()>new Date(e.maxDate))}}}}renderRow(e){return e.rowFields.map(t=>this.renderField(t)).filter(Boolean)}renderRows(e){return e.map(t=>this.renderRow(t))}variables(e,t){const n={};for(const l of t.entries()){const[r,u]=l,p=e.rows.find(c=>c.rowFields.find(g=>g.handle===r))?.rowFields.find(c=>c.handle===r);n[r]={...p,value:u}}const s={};for(const l in n)switch(n[l].typeName){case"Field_Date":s[l]=new Date(n[l].value);break;default:s[l]=n[l].value}return[n,s]}}const h={pages:[],rows:[{rowFields:[{defaultValue:"",displayName:"Name",name:"Name",errorMessage:"",handle:"name",instructions:"",placeholder:"",required:!0,typeName:"Field_SingleLineText"},{defaultValue:"",displayName:"Name 2",name:"Name 2",errorMessage:"",handle:"name2",instructions:"",placeholder:"",required:!0,typeName:"Field_SingleLineText"}]},{rowFields:[{defaultValue:"",displayName:"Text",name:"Text",errorMessage:"",handle:"text",instructions:"",placeholder:"",typeName:"Field_MultiLineText"}]}]};function k(){const i=m(),e=m(),t=m(!1),n=new E;return a("div",null,[e.value?a("div",null,[a("h2",null,[y("Geschafft")]),a("p",null,[e.value])]):a("form",{class:"flex flex-col gap-8",onSubmit:s=>{s.preventDefault();const[l,r]=n.variables(h,new FormData(s.currentTarget));console.info("FORM -> SUBMIT",l,r),t.value=!0,setTimeout(()=>{i.value="Failed",t.value=!1},2e3)}},[n.renderRows(h.rows).map((s,l)=>a("div",{key:`form_row_${l}`,class:"flex gap-8"},[s.map((r,u)=>{if(r)return a("div",{key:`form_row_${l}_field_${u}`,class:"flex-1"},[r.type==="heading"?a("div",null,[a("h2",null,[r.label])]):a(x,{field:r},null)])})])),a("div",null,[a(F,{type:"submit",disabled:!!t.value,class:"overflow-hidden"},{default:()=>[a(f("a-adaptive"),null,{default:()=>[a("div",{class:"flex items-center gap-2"},[a("span",null,["Submit"]),t.value?a("span",{class:"loading-indicator flex-none"},null):""])]})]})])]),i.value?a("div",null,[a("p",null,[i.value])]):null])}export{k as SomeForm};
